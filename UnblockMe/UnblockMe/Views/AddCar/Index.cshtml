@using Microsoft.AspNetCore.Identity
@using UnblockMe.Services
@inject SignInManager<Users> SignInManager
@inject UserManager<Users> UserManager
@inject IUserService _userService
@inject ICarsService _carsService
@using System.Web;
@model Cars

<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>
<script src="~/lib/jquery-validation/dist/additional-methods.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>


<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#AddCar">
    Add Car
</button>

<div class="modal fade" id="AddCar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add a car</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("Index", "AddCar", FormMethod.Post))
                {
                    <p>
                        @Html.LabelFor(c => c.LicensePlate)
                        @Html.TextBoxFor(c => c.LicensePlate, new { @placeholder = "License Plate", @required = "required" })

                    </p>

                    <p>
                        @Html.LabelFor(c => c.Brand)
                        @Html.TextBoxFor(c => c.Brand, new { @placeholder = "Brand", @required = "required" })

                    </p>
                    <p>
                        @Html.LabelFor(c => c.Color)
                        @Html.TextBoxFor(c => c.Color, new { @placeholder = "Color", @required = "required" })
                    </p>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Add Car</button>
                    </div>

                }
            </div>

        </div>
    </div>
</div>

<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#EditCar">
    Edit Car
</button>


<div class="modal fade" id="EditCar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit a car!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editCarForm">
                    <select id="selectEditCar">
                        @foreach (var element in _userService.GetCarsListOfUser(_userService.GetLoggedInUser()))
                        {
                            <option value="@element.LicensePlate">@element.LicensePlate</option>
                        }
                    </select>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>


<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ParkCar">
    Park Car
</button>

<div class="modal fade" id="ParkCar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Park a car</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Park a car!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<script>
    $("#selectEditCar").change(function EditCar(event) {
        
        $.ajax({
            url: "GetCarByLicensePlate",
            data: {
                licensePlate: $(this).val()
            },
            success: function (data) {
                console.log(data);

            }

        });
      

    });
</script>