@model (Users, List<Cars>, Users, List<Cars>,int)
@using Microsoft.AspNetCore.Identity
@inject SignInManager<Users> SignInManager



<script src="~/lib/jquery/dist/jquery.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
<link href="~/css/Profile.css" rel="stylesheet" />
<link href="~/css/rating.css" rel="stylesheet" />
<div class="profilecontainer" align="center">
    <p><img id="profilePicture" style="width:350px;height:350px; object-fit:cover" src="/Profile/@Model.Item3.Id/Photo" /></p>
    <p>@Model.Item3.FirstName  @Model.Item3.LastName</p>
    <p>@Model.Item3.PhoneNumber <img class="phone" src="https://img.icons8.com/office/16/000000/phone.png" /></p>
    <p>@Model.Item3.Email <img class="email" src="https://img.icons8.com/ultraviolet/40/000000/new-post.png" /></p>

    <p>
        <form class="rating noHover ">
            <div class="inputsContainer">
                @for (int i = 9; i >= 1; i--)
                {

                    if (i == Model.Item5-1)
                    {
                        <input class="radio" type="radio" id=@("star"+i) name="rating" value=@i.ToString() disabled checked/>

                    }
                    else
                    {

                        <input class="radio" type="radio" id=@("star"+i) name="rating" value=@i.ToString() disabled />
                    }
                    if (i % 2 == 1)
                    {
                        <label class="full" for=@("star"+i)></label>
                    }
                    else
                    {
                        <label class="half" for=@("star"+i)></label>
                    }

                }
            </div>
          
        </form>
    </p>
   

</div>
<div class="container">
    @if (SignInManager.IsSignedIn(User))
    {

        <div class="buttons" align="center">

            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#UnblockMe">
                Unblock me!
            </button>

            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#BlockedYou">
                I have blocked you!
            </button>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#Rate">
                Rate
            </button>
        </div>

        <div class="modal custom fade" id="UnblockMe" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Unblock Me!</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form method="post" id="form2">
                            <p>Contact Method:</p>
                            <label for="ContactSMS">SMS</label>
                            <input type="radio" name="Contact" value="SMS" id="Contact" checked />
                            <label for="ContactEmail">Email</label>
                            <input type="radio" name="Contact" value="Email" id="Contact" />
                            <br />
                            <label for="myplates">My Cars:</label>
                            <select name="myplates" id="myplates" required>
                                @foreach (var element in Model.Item2)
                                {
                                    <option value="@element.LicensePlate">@element.LicensePlate</option>
                                }


                            </select>
                            <label for="yourplates">@(Model.Item3.FirstName)'s Cars</label>
                            <select name="yourplates" id="yourplates" required>
                                @foreach (var element in Model.Item4)
                                {
                                    <option value="@element.LicensePlate">@element.LicensePlate</option>
                                }
                            </select>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary" id="button">Send</button>


                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>

        <div class="modal custom fade" id="BlockedYou" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">I have blocked you!</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">

                        <form method="post" id="form1">
                            <p>Contact Method:</p>
                            <label for="ContactSMS">SMS</label>
                            <input type="radio" name="Contact" value="SMS" id="Contact" checked />
                            <label for="ContactEmail">Email</label>
                            <input type="radio" name="Contact" value="Email" id="Contact" />
                            <br />
                            <label for="myplates">My Cars:</label>
                            <select name="myplates" id="myplates" required>
                                @foreach (var element in Model.Item2)
                                {
                                    <option value="@element.LicensePlate">@element.LicensePlate</option>
                                }


                            </select>
                            <label for="yourplates">@(Model.Item3.FirstName)'s Cars</label>
                            <select name="yourplates" id="yourplates" required>
                                @foreach (var element in Model.Item4)
                                {
                                    <option value="@element.LicensePlate">@element.LicensePlate</option>
                                }
                            </select>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary" id="button">Send</button>


                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>

    }
</div>
<script>

    $("#form1").submit(function blockedyou(event) {
        event.preventDefault();
        $.ajax({
            url: "BlockedYouAction",
            data: {
                Contact: $("#Contact").val(),
                MyPlate: $("#myplates").val(),
                YourPlate: $("#yourplates").val()
            },
            success: function (status) {
                $("#BlockedYou").modal('hide');
                toastNotifySuccess(status, 1000);

            },
            error: function (error) {

                $("#BlockedYou").modal('hide');
                toastNotifyError(error.responseText, 1000);
            }

        });


    });
    $("#form2").submit(function unblockme(event) {
        event.preventDefault();
        $.ajax({
            url: "BlockedMeAction",
            data: {
                Contact: $("#Contact").val(),
                MyPlate: $("#myplates").val(),
                YourPlate: $("#yourplates").val()
            },
            success: function (status) {

                console.log(status);
                $("#UnblockMe").modal('hide');
                toastNotifySuccess(status, 1000);

            },
            error: function (error) {

                $("#UnblockMe").modal('hide');
                toastNotifyError(error.responseText, 1000);
            }
        });


    });
   
</script>
